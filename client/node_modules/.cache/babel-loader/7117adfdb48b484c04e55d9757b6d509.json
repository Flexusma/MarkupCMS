{"remainingRequest":"B:\\Gitkraken\\MarkupCMS\\client\\node_modules\\thread-loader\\dist\\cjs.js!B:\\Gitkraken\\MarkupCMS\\client\\node_modules\\babel-loader\\lib\\index.js!B:\\Gitkraken\\MarkupCMS\\client\\node_modules\\eslint-loader\\index.js??ref--13-0!B:\\Gitkraken\\MarkupCMS\\client\\src\\auth\\authService.js","dependencies":[{"path":"B:\\Gitkraken\\MarkupCMS\\client\\src\\auth\\authService.js","mtime":1610292725119},{"path":"B:\\Gitkraken\\MarkupCMS\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"B:\\Gitkraken\\MarkupCMS\\client\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"B:\\Gitkraken\\MarkupCMS\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"B:\\Gitkraken\\MarkupCMS\\client\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkI6L0dpdGtyYWtlbi9NYXJrdXBDTVMvY2xpZW50L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJCOi9HaXRrcmFrZW4vTWFya3VwQ01TL2NsaWVudC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkI6L0dpdGtyYWtlbi9NYXJrdXBDTVMvY2xpZW50L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiQjovR2l0a3Jha2VuL01hcmt1cENNUy9jbGllbnQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKaW1wb3J0IHsgYXBpLCBjb25zdGFudCwgZXJyb3JfbXNnLCB2dWUsIGFwcCB9IGZyb20gIkAvbWFpbiI7CmltcG9ydCB7IE5leHRFcnJvclJlZGlyIH0gZnJvbSAiQC9yb3V0ZXIvcm91dGVyX3V0aWxzIjsKaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJzsKCnZhciBBdXRoU2VydmljZSA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgZnVuY3Rpb24gQXV0aFNlcnZpY2UoKSB7CiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQXV0aFNlcnZpY2UpOwoKICAgIF9kZWZpbmVQcm9wZXJ0eSh0aGlzLCAidXNlciIsIHVuZGVmaW5lZCk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoQXV0aFNlcnZpY2UsIFt7CiAgICBrZXk6ICJpc0F1dGhlbnRpY2F0ZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGlzQXV0aGVudGljYXRlZCgpIHsKICAgICAgaWYgKHRoaXMuZ2V0QXV0aCgpID09PSB1bmRlZmluZWQpIHRoaXMuY2hlY2tBdXRoUmVxKCk7CiAgICAgIHJldHVybiB0aGlzLmdldEF1dGgoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJsb2dpblJlZGlyZWN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsb2dpblJlZGlyZWN0KCkgewogICAgICB0aGlzLmNoZWNrQXV0aFJlcSgpOwogICAgICB0aGlzLnB1c2goImxvZ2luIik7CiAgICB9CiAgfSwgewogICAga2V5OiAibG9nb3V0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsb2dvdXQob2JqKSB7CiAgICAgIHZhciBsb2dvdXQgPSBheGlvcyh7CiAgICAgICAgbWV0aG9kOiAnZGVsZXRlJywKICAgICAgICB1cmw6IGFwaS5hcGlfYmFzZV91cmwgKyBhcGkuYXBpX3Nlc3Npb25fcGF0aAogICAgICB9KTsKICAgICAgQXV0aFNlcnZpY2VJbnN0YW5jZS5zZXRBdXRoKGZhbHNlKTsKICAgICAgdGhpcy5hdXRoQXhpb3NOb1JlZChsb2dvdXQpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIGNvbnNvbGUubG9nKHJlcyk7CgogICAgICAgIGlmIChyZXMuZGF0YS5pbmZvLmNvZGUgPT09IDIwMCkgewogICAgICAgICAgaWYgKG9iaiAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIC8vaWYgKG9iai5yZXR1cm5UbyAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIC8vICAgIHZ1ZS4kcm91dGVyLnB1c2gob2JqLnJldHVyblRvKTsKICAgICAgICAgICAgLy99IGVsc2UgewogICAgICAgICAgICBhcHAuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICBBdXRoU2VydmljZUluc3RhbmNlLnNldEF1dGgoZmFsc2UpOwogICAgICAgICAgICAgIEF1dGhTZXJ2aWNlSW5zdGFuY2UucHVzaChjb25zdGFudC5ob21lX3BhZ2VfbmFtZSk7CiAgICAgICAgICAgICAgYXBwLiRyb290LiRyb3V0ZXIuZ28oMCk7CiAgICAgICAgICAgICAgYXBwLiRyb290LiRyb3V0ZXIuZ28oMCk7CiAgICAgICAgICAgIH0pOyAvLyB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgICAgdGhpcy5jaGVja0F1dGhSZXEoKTsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJyb3V0ZUF1dGhDaGVjayIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3JvdXRlQXV0aENoZWNrID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKG5leHQpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrQXV0aFJlcSgpOwoKICAgICAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmlzQXV0aGVudGljYXRlZCgpKSB7CiAgICAgICAgICAgICAgICAgICAgbmV4dCgpOwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIC8vanVzdCBpbiBjYXNlIEF1dGhBeGlvcyBmYWlscwogICAgICAgICAgICAgICAgICAgIG5leHQoewogICAgICAgICAgICAgICAgICAgICAgbmFtZTogImxvZ2luIgogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICAgICAgICBOZXh0RXJyb3JSZWRpcihlcnJvcl9tc2cuY291bGRfbm90X3ZlcmlmeV9sb2dpbi5jb2RlLCBlcnJvcl9tc2cuY291bGRfbm90X3ZlcmlmeV9sb2dpbi5tZXNzYWdlLCBuZXh0KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHJvdXRlQXV0aENoZWNrKF94KSB7CiAgICAgICAgcmV0dXJuIF9yb3V0ZUF1dGhDaGVjay5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gcm91dGVBdXRoQ2hlY2s7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJhdXRoQXhpb3MiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9hdXRoQXhpb3MgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKGF4aW8sIG5leHQpIHsKICAgICAgICB2YXIgcmVzcDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgdGhpcy5jaGVja0F1dGhSZXEoKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiBheGlvOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICByZXNwID0gX2NvbnRleHQyLnNlbnQ7CgogICAgICAgICAgICAgICAgaWYgKCEocmVzcC5kYXRhLmluZm8uY29kZSA9PT0gNjAxKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoIShuZXh0ICE9PSB1bmRlZmluZWQpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTA7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIG5leHQoewogICAgICAgICAgICAgICAgICBuYW1lOiAibG9naW4iCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBmYWxzZSk7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgICB2dWUuJHJvdXRlci5wdXNoKCJsb2dpbiIpOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIGZhbHNlKTsKCiAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTU7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCByZXNwKTsKCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGF1dGhBeGlvcyhfeDIsIF94MykgewogICAgICAgIHJldHVybiBfYXV0aEF4aW9zLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBhdXRoQXhpb3M7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJhdXRoQXhpb3NOb1JlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2F1dGhBeGlvc05vUmVkID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMyhheGlvKSB7CiAgICAgICAgdmFyIHJlc3A7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tBdXRoUmVxKCk7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gYXhpbzsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgcmVzcCA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIHJlc3ApOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBhdXRoQXhpb3NOb1JlZChfeDQpIHsKICAgICAgICByZXR1cm4gX2F1dGhBeGlvc05vUmVkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBhdXRoQXhpb3NOb1JlZDsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImxvZ2luV2l0aENyZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9sb2dpbldpdGhDcmVkID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNCh1c2VyLCBwYXNzKSB7CiAgICAgICAgdmFyIHJlc3A7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiBheGlvcy5wb3N0KGFwaS5hcGlfYmFzZV91cmwgKyBhcGkuYXBpX3Nlc3Npb25fcGF0aCwgIiIsIHsKICAgICAgICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICAgICAgICd4X3VzZXInOiB1c2VyLAogICAgICAgICAgICAgICAgICAgICd4X3Bhc3MnOiBwYXNzCiAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgICAgICByZXNwID0gX2NvbnRleHQ0LnNlbnQ7CiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwKTsKCiAgICAgICAgICAgICAgICBpZiAoIShyZXNwLmRhdGEuaW5mby5jb2RlID09PSAyMDApKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMudXNlciA9IHJlc3AuZGF0YS5kYXRhWzBdOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcC5kYXRhLmRhdGEpOwogICAgICAgICAgICAgICAgdGhpcy5zZXRBdXRoKHRydWUpOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coInNldHRpbmcgYXV0aCB0byB0cnVlIik7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgcmVzcC5kYXRhKTsKCiAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuYWJydXB0KCJyZXR1cm4iLCByZXNwLmRhdGEpOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU0LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gbG9naW5XaXRoQ3JlZChfeDUsIF94NikgewogICAgICAgIHJldHVybiBfbG9naW5XaXRoQ3JlZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gbG9naW5XaXRoQ3JlZDsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImNoZWNrQXV0aFJlcSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2hlY2tBdXRoUmVxKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgYXhpb3MuZ2V0KGFwaS5hcGlfYmFzZV91cmwgKyBhcGkuYXBpX3Nlc3Npb25fY2hlY2tfcGF0aCkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgX3RoaXMuY2hlY2tBdXRoKHJlcyk7CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogImNoZWNrQXV0aFJlcUFzeW5jIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfY2hlY2tBdXRoUmVxQXN5bmMgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KCkgewogICAgICAgIHZhciByZXM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0NS5uZXh0ID0gMjsKICAgICAgICAgICAgICAgIHJldHVybiBheGlvcy5nZXQoYXBpLmFwaV9iYXNlX3VybCArIGFwaS5hcGlfc2Vzc2lvbl9jaGVja19wYXRoKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQ1LnNlbnQ7CiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrQXV0aChyZXMpOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTUsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBjaGVja0F1dGhSZXFBc3luYygpIHsKICAgICAgICByZXR1cm4gX2NoZWNrQXV0aFJlcUFzeW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBjaGVja0F1dGhSZXFBc3luYzsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImlzQXV0aFVzZXIiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9pc0F1dGhVc2VyID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNigpIHsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAyOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuY2hlY2tBdXRoUmVxQXN5bmMoKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIHsKICAgICAgICAgICAgICAgICAgaXNBdXRoOiB0aGlzLmdldEF1dGgoKSwKICAgICAgICAgICAgICAgICAgdXNlcjogdGhpcy51c2VyCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU2LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gaXNBdXRoVXNlcigpIHsKICAgICAgICByZXR1cm4gX2lzQXV0aFVzZXIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGlzQXV0aFVzZXI7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJjaGVja0F1dGgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNoZWNrQXV0aChyZXMpIHsKICAgICAgY29uc29sZS5sb2coIkNoZWNraW5nIHVzZXIgYXV0aC4gR290IHJlc3BvbnNlOiAiLCByZXMuZGF0YSk7CgogICAgICBpZiAocmVzLmRhdGEuaW5mby5jb2RlID09PSAyMDApIHsKICAgICAgICBjb25zb2xlLmxvZygiQXV0aDogdHJ1ZSIpOwogICAgICAgIHRoaXMuc2V0QXV0aCh0cnVlKTsKICAgICAgICB0aGlzLnVzZXIgPSByZXMuZGF0YS5kYXRhOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbnNvbGUubG9nKCJBdXRoOiBmYWxzZSIpOwogICAgICAgIHRoaXMuc2V0QXV0aChmYWxzZSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJwdXNoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBwdXNoKHRvKSB7CiAgICAgIGNvbnNvbGUubG9nKGFwcCk7CgogICAgICBpZiAoYXBwLiRyb3V0ZS5uYW1lICE9PSB0bykgewogICAgICAgIGFwcC4kcm91dGVyLnB1c2goewogICAgICAgICAgbmFtZTogdG8KICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInNldEF1dGgiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldEF1dGgodCkgewogICAgICBhcHAuaXNBdXRoID0gdDsKICAgIH0KICB9LCB7CiAgICBrZXk6ICJnZXRBdXRoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRBdXRoKCkgewogICAgICBpZiAoYXBwICE9PSB1bmRlZmluZWQpIHJldHVybiBhcHAuaXNBdXRoO2Vsc2UgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0KICB9XSk7CgogIHJldHVybiBBdXRoU2VydmljZTsKfSgpOwoKdmFyIEF1dGhTZXJ2aWNlSW5zdGFuY2UgPSBuZXcgQXV0aFNlcnZpY2UoKTsKZXhwb3J0IGRlZmF1bHQgQXV0aFNlcnZpY2VJbnN0YW5jZTsKZXhwb3J0IGZ1bmN0aW9uIGluaXRBdXRoU2VydmljZSh2dWUpIHsKICBBdXRoU2VydmljZUluc3RhbmNlLmNoZWNrQXV0aFJlcSgpOwogIHZ1ZS5jb25maWcuZ2xvYmFsUHJvcGVydGllcy4kYXV0aCA9IEF1dGhTZXJ2aWNlSW5zdGFuY2U7Cn0="},{"version":3,"sources":["B:/Gitkraken/MarkupCMS/client/src/auth/authService.js"],"names":["api","constant","error_msg","vue","app","NextErrorRedir","axios","AuthService","undefined","getAuth","checkAuthReq","push","obj","logout","method","url","api_base_url","api_session_path","AuthServiceInstance","setAuth","authAxiosNoRed","then","res","console","log","data","info","code","$nextTick","home_page_name","$root","$router","go","next","isAuthenticated","name","e","could_not_verify_login","message","axio","resp","user","pass","post","headers","get","api_session_check_path","checkAuth","checkAuthReqAsync","isAuth","to","$route","t","initAuthService","config","globalProperties","$auth"],"mappings":"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","sourcesContent":["import {api, constant, error_msg, vue, app} from \"@/main\";\r\nimport {NextErrorRedir} from \"@/router/router_utils\";\r\nimport axios from 'axios';\r\n\r\nclass AuthService{\r\n\r\n\r\n    isAuthenticated(){\r\n        if(this.getAuth()===undefined)\r\n            this.checkAuthReq();\r\n        return this.getAuth()\r\n    }\r\n\r\n    user = undefined;\r\n\r\n    loginRedirect(){\r\n        this.checkAuthReq();\r\n        this.push(\"login\");\r\n    }\r\n\r\n    logout(obj){\r\n\r\n        let logout = axios({\r\n            method: 'delete',\r\n            url: api.api_base_url+api.api_session_path,\r\n        })\r\n        AuthServiceInstance.setAuth(false);\r\n        this.authAxiosNoRed(logout).then(function (res){\r\n            console.log(res)\r\n\r\n            if(res.data.info.code===200) {\r\n                if (obj !== undefined) {\r\n                    //if (obj.returnTo !== undefined) {\r\n                    //    vue.$router.push(obj.returnTo);\r\n                    //} else {\r\n                    app.$nextTick(()=>{\r\n                        AuthServiceInstance.setAuth(false);\r\n                        AuthServiceInstance.push(constant.home_page_name);\r\n                        app.$root.$router.go(0);\r\n                        app.$root.$router.go(0);\r\n                    });\r\n\r\n                   // }\r\n                }\r\n            }\r\n        });\r\n        this.checkAuthReq();\r\n\r\n\r\n    }\r\n\r\n    async routeAuthCheck(next){\r\n        this.checkAuthReq();\r\n        try {\r\n            if(this.isAuthenticated()){\r\n                next();\r\n            } else {\r\n                //just in case AuthAxios fails\r\n                next({name: \"login\"});\r\n            }\r\n        }catch (e){\r\n            console.log(e);\r\n            NextErrorRedir(error_msg.could_not_verify_login.code,error_msg.could_not_verify_login.message,next);\r\n        }\r\n    }\r\n\r\n    async authAxios(axio,next){\r\n        this.checkAuthReq();\r\n        let resp= await axio;\r\n        if(resp.data.info.code===601){\r\n            if(next!==undefined) {\r\n                next({name: \"login\"});\r\n                return false;\r\n            }else {\r\n                vue.$router.push(\"login\");\r\n                return false;\r\n            }\r\n        } else\r\n            return resp;\r\n    }\r\n\r\n    async authAxiosNoRed(axio){\r\n        this.checkAuthReq();\r\n        let resp = await axio;\r\n        return resp;\r\n    }\r\n\r\n    async loginWithCred(user, pass){\r\n        let resp = await axios.post(api.api_base_url+api.api_session_path,\"\",{headers:{\r\n            'x_user':user,\r\n            'x_pass':pass\r\n        },\r\n        });\r\n        console.log(resp);\r\n        if(resp.data.info.code===200){\r\n            this.user = resp.data.data[0];\r\n            console.log(resp.data.data)\r\n            this.setAuth(true);\r\n            console.log(\"setting auth to true\");\r\n            return resp.data;\r\n        }else return resp.data;\r\n    }\r\n\r\n    checkAuthReq(){\r\n        axios.get(api.api_base_url+api.api_session_check_path).then((res) => {\r\n            this.checkAuth(res);\r\n        })\r\n    }\r\n\r\n    async checkAuthReqAsync(){\r\n        const res = await axios.get(api.api_base_url+api.api_session_check_path);\r\n        this.checkAuth(res);\r\n    }\r\n\r\n    async isAuthUser(){\r\n        await this.checkAuthReqAsync();\r\n        return {\r\n            isAuth: this.getAuth(),\r\n            user: this.user\r\n        };\r\n\r\n    }\r\n\r\n    checkAuth(res){\r\n        console.log(\"Checking user auth. Got response: \",res.data);\r\n        if(res.data.info.code===200) {\r\n            console.log(\"Auth: true\")\r\n            this.setAuth(true)\r\n            this.user=res.data.data;\r\n        }\r\n        else{\r\n            console.log(\"Auth: false\")\r\n            this.setAuth(false)\r\n        }\r\n    }\r\n\r\n\r\n    push(to){\r\n        console.log(app)\r\n        if(app.$route.name!==to){\r\n            app.$router.push({name: to});\r\n        }\r\n    }\r\n    setAuth(t){\r\n      app.isAuth = t;\r\n    }\r\n    getAuth(){\r\n        if(app!==undefined)\r\n            return app.isAuth;\r\n        else return undefined;\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\nlet AuthServiceInstance = new AuthService();\r\n\r\nexport default AuthServiceInstance;\r\n\r\nexport function initAuthService(vue){\r\n\r\n    AuthServiceInstance.checkAuthReq();\r\n    vue.config.globalProperties.$auth=AuthServiceInstance;\r\n\r\n}"]}]}