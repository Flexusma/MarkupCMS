{"remainingRequest":"C:\\Users\\craft\\OneDrive - willigis-online.de\\Dokumente\\GitKraken\\MarkupCMS\\client\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\craft\\OneDrive - willigis-online.de\\Dokumente\\GitKraken\\MarkupCMS\\client\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\craft\\OneDrive - willigis-online.de\\Dokumente\\GitKraken\\MarkupCMS\\client\\src\\auth\\authService.js","dependencies":[{"path":"C:\\Users\\craft\\OneDrive - willigis-online.de\\Dokumente\\GitKraken\\MarkupCMS\\client\\src\\auth\\authService.js","mtime":1605908755909},{"path":"C:\\Users\\craft\\OneDrive - willigis-online.de\\Dokumente\\GitKraken\\MarkupCMS\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\craft\\OneDrive - willigis-online.de\\Dokumente\\GitKraken\\MarkupCMS\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\craft\\OneDrive - willigis-online.de\\Dokumente\\GitKraken\\MarkupCMS\\client\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQzovVXNlcnMvY3JhZnQvT25lRHJpdmUgLSB3aWxsaWdpcy1vbmxpbmUuZGUvRG9rdW1lbnRlL0dpdEtyYWtlbi9NYXJrdXBDTVMvY2xpZW50L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJDOi9Vc2Vycy9jcmFmdC9PbmVEcml2ZSAtIHdpbGxpZ2lzLW9ubGluZS5kZS9Eb2t1bWVudGUvR2l0S3Jha2VuL01hcmt1cENNUy9jbGllbnQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJDOi9Vc2Vycy9jcmFmdC9PbmVEcml2ZSAtIHdpbGxpZ2lzLW9ubGluZS5kZS9Eb2t1bWVudGUvR2l0S3Jha2VuL01hcmt1cENNUy9jbGllbnQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJDOi9Vc2Vycy9jcmFmdC9PbmVEcml2ZSAtIHdpbGxpZ2lzLW9ubGluZS5kZS9Eb2t1bWVudGUvR2l0S3Jha2VuL01hcmt1cENNUy9jbGllbnQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKaW1wb3J0ICogYXMgYXhpb3MgZnJvbSAiY29yZS1qcy9pbnRlcm5hbHMvaW50ZXJuYWwtc3RhdGUiOwppbXBvcnQgeyBhcGksIGVycm9yX21zZyB9IGZyb20gIkAvbWFpbiI7CmltcG9ydCB7IE5leHRFcnJvclJlZGlyIH0gZnJvbSAiQC9yb3V0ZXIvcm91dGVyX3V0aWxzIjsKdmFyIEF1dGhTZXJ2aWNlSW5zdGFuY2U7CmV4cG9ydCBkZWZhdWx0IEF1dGhTZXJ2aWNlSW5zdGFuY2U7CmV4cG9ydCBmdW5jdGlvbiBpbml0QXV0aFNlcnZpY2UodnVlKSB7CiAgQXV0aFNlcnZpY2VJbnN0YW5jZSA9IG5ldyBBdXRoU2VydmljZSgpOwogIHZ1ZS5wcm90b3R5cGUuJGF1dGggPSBBdXRoU2VydmljZUluc3RhbmNlOwp9Cgp2YXIgQXV0aFNlcnZpY2UgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEF1dGhTZXJ2aWNlKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEF1dGhTZXJ2aWNlKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImlzQXV0aGVudGljYXRlZCIsIGZhbHNlKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgImNvb2tpZSIsIHVuZGVmaW5lZCk7CiAgfQoKICBfY3JlYXRlQ2xhc3MoQXV0aFNlcnZpY2UsIFt7CiAgICBrZXk6ICJsb2dpblJlZGlyZWN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsb2dpblJlZGlyZWN0KCkgewogICAgICB0aGlzLnJvdXRlci5wdXNoKCJsb2dpbiIpOwogICAgfQogIH0sIHsKICAgIGtleTogImxvZ291dCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9nb3V0KG9iaikgewogICAgICB2YXIgbG9nb3V0ID0gYXhpb3MuZGVsZXRlKCk7CiAgICAgIHRoaXMuYXhpb3NOb0NyZWQoKTsKCiAgICAgIGlmIChvYmogIT09IHVuZGVmaW5lZCkgewogICAgICAgIGlmIChvYmoucmV0dXJuVG8gIT09IHVuZGVmaW5lZCkge30KICAgICAgfQogICAgfQogIH0sIHsKICAgIGtleTogInJvdXRlQXV0aENoZWNrIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfcm91dGVBdXRoQ2hlY2sgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUobmV4dCkgewogICAgICAgIHZhciBheDsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBheCA9IGF4aW9zLmdldChhcGkuYXBpX2Jhc2VfdXJsICsgYXBpLmFwaV90b2tlbl9jaGVja191cmwpOwogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDE7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmF1dGhBeGlvcyhheCwgbmV4dCk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIGlmICghX2NvbnRleHQuc2VudCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgbmV4dCgpOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDk7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgICAgLy9qdXN0IGluIGNhc2UgQXV0aEF4aW9zIGZhaWxzCiAgICAgICAgICAgICAgICBuZXh0KHsKICAgICAgICAgICAgICAgICAgbmFtZTogImxvZ2luIgogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxNDsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDExOwogICAgICAgICAgICAgICAgX2NvbnRleHQudDAgPSBfY29udGV4dFsiY2F0Y2giXSgxKTsKICAgICAgICAgICAgICAgIE5leHRFcnJvclJlZGlyKGVycm9yX21zZy5jb3VsZF9ub3RfdmVyaWZ5X2xvZ2luLmNvZGUsIGVycm9yX21zZy5jb3VsZF9ub3RfdmVyaWZ5X2xvZ2luLm1lc3NhZ2UpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgdGhpcywgW1sxLCAxMV1dKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gcm91dGVBdXRoQ2hlY2soX3gpIHsKICAgICAgICByZXR1cm4gX3JvdXRlQXV0aENoZWNrLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiByb3V0ZUF1dGhDaGVjazsKICAgIH0oKQogIH0sIHsKICAgIGtleTogImF1dGhBeGlvcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2F1dGhBeGlvcyA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIoYXhpbywgbmV4dCkgewogICAgICAgIHZhciByZXNwOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gYXhpbzsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmVzcCA9IF9jb250ZXh0Mi5zZW50OwoKICAgICAgICAgICAgICAgIGlmICghKHJlc3AuaW5mby5jb2RlID09PSA2MDEpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmICghKG5leHQgIT09IHVuZGVmaW5lZCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBuZXh0KHsKICAgICAgICAgICAgICAgICAgbmFtZTogImxvZ2luIgogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgZmFsc2UpOwoKICAgICAgICAgICAgICBjYXNlIDk6CiAgICAgICAgICAgICAgICB0aGlzLnJvdXRlci5wdXNoKCJsb2dpbiIpOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIsIGZhbHNlKTsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCByZXNwKTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGF1dGhBeGlvcyhfeDIsIF94MykgewogICAgICAgIHJldHVybiBfYXV0aEF4aW9zLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBhdXRoQXhpb3M7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJheGlvc05vQ3JlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX2F4aW9zTm9DcmVkID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMyhheGlvKSB7CiAgICAgICAgdmFyIHJlc3A7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUzJChfY29udGV4dDMpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGF4aW8ud2l0aENyZWRlbnRpYWxzID0gZmFsc2U7CiAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gYXhpbzsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgcmVzcCA9IF9jb250ZXh0My5zZW50OwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIHJlc3ApOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBheGlvc05vQ3JlZChfeDQpIHsKICAgICAgICByZXR1cm4gX2F4aW9zTm9DcmVkLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBheGlvc05vQ3JlZDsKICAgIH0oKQogIH1dKTsKCiAgcmV0dXJuIEF1dGhTZXJ2aWNlOwp9KCk7"},{"version":3,"sources":["C:/Users/craft/OneDrive - willigis-online.de/Dokumente/GitKraken/MarkupCMS/client/src/auth/authService.js"],"names":["axios","api","error_msg","NextErrorRedir","AuthServiceInstance","initAuthService","vue","AuthService","prototype","$auth","undefined","router","push","obj","logout","delete","axiosNoCred","returnTo","next","ax","get","api_base_url","api_token_check_url","authAxios","name","could_not_verify_login","code","message","axio","resp","info","withCredentials"],"mappings":";;;;;AAAA,OAAO,KAAKA,KAAZ,MAAuB,kCAAvB;AACA,SAAQC,GAAR,EAAaC,SAAb,QAA6B,QAA7B;AACA,SAAQC,cAAR,QAA6B,uBAA7B;AAEA,IAAIC,mBAAJ;AAEA,eAAeA,mBAAf;AAEA,OAAO,SAASC,eAAT,CAAyBC,GAAzB,EAA6B;AAEhCF,EAAAA,mBAAmB,GAAG,IAAIG,WAAJ,EAAtB;AAEAD,EAAAA,GAAG,CAACE,SAAJ,CAAcC,KAAd,GAAoBL,mBAApB;AAEH;;IAEKG,W;;;;6CAEgB,K;;oCACTG,S;;;;;oCAEM;AACX,WAAKC,MAAL,CAAYC,IAAZ,CAAiB,OAAjB;AACH;;;2BAEMC,G,EAAI;AAEP,UAAIC,MAAM,GAAGd,KAAK,CAACe,MAAN,EAAb;AAEA,WAAKC,WAAL;;AAEA,UAAGH,GAAG,KAAGH,SAAT,EAAmB;AACf,YAAGG,GAAG,CAACI,QAAJ,KAAeP,SAAlB,EAA4B,CAE3B;AACJ;AACJ;;;;qGAEoBQ,I;;;;;;AACbC,gBAAAA,E,GAAKnB,KAAK,CAACoB,GAAN,CAAUnB,GAAG,CAACoB,YAAJ,GAAiBpB,GAAG,CAACqB,mBAA/B,C;;;uBAEK,KAAKC,SAAL,CAAeJ,EAAf,EAAmBD,IAAnB,C;;;;;;;;AACNA,gBAAAA,IAAI;;;;;AAEJ;AACAA,gBAAAA,IAAI,CAAC;AAACM,kBAAAA,IAAI,EAAE;AAAP,iBAAD,CAAJ;;;;;;;;;AAGJrB,gBAAAA,cAAc,CAACD,SAAS,CAACuB,sBAAV,CAAiCC,IAAlC,EAAuCxB,SAAS,CAACuB,sBAAV,CAAiCE,OAAxE,CAAd;;;;;;;;;;;;;;;;;;;iGAIQC,I,EAAKV,I;;;;;;;uBACDU,I;;;AAAZC,gBAAAA,I;;sBACDA,IAAI,CAACC,IAAL,CAAUJ,IAAV,KAAiB,G;;;;;sBACbR,IAAI,KAAGR,S;;;;;AACNQ,gBAAAA,IAAI,CAAC;AAACM,kBAAAA,IAAI,EAAE;AAAP,iBAAD,CAAJ;kDACO,K;;;AAEP,qBAAKb,MAAL,CAAYC,IAAZ,CAAiB,OAAjB;kDACO,K;;;;;;;kDAGJiB,I;;;;;;;;;;;;;;;;;;;mGAGGD,I;;;;;;AACdA,gBAAAA,IAAI,CAACG,eAAL,GAAqB,KAArB;;uBACiBH,I;;;AAAbC,gBAAAA,I;kDACGA,I","sourcesContent":["import * as axios from \"core-js/internals/internal-state\";\r\nimport {api, error_msg} from \"@/main\";\r\nimport {NextErrorRedir} from \"@/router/router_utils\";\r\n\r\nlet AuthServiceInstance;\r\n\r\nexport default AuthServiceInstance;\r\n\r\nexport function initAuthService(vue){\r\n\r\n    AuthServiceInstance = new AuthService();\r\n\r\n    vue.prototype.$auth=AuthServiceInstance;\r\n\r\n}\r\n\r\nclass AuthService{\r\n\r\n    isAuthenticated = false;\r\n    cookie = undefined;\r\n\r\n    loginRedirect(){\r\n        this.router.push(\"login\");\r\n    }\r\n\r\n    logout(obj){\r\n\r\n        let logout = axios.delete()\r\n\r\n        this.axiosNoCred()\r\n\r\n        if(obj!==undefined){\r\n            if(obj.returnTo!==undefined){\r\n\r\n            }\r\n        }\r\n    }\r\n\r\n    async routeAuthCheck(next){\r\n        let ax = axios.get(api.api_base_url+api.api_token_check_url);\r\n        try {\r\n            if (await this.authAxios(ax, next)) {\r\n                next();\r\n            } else {\r\n                //just in case AuthAxios fails\r\n                next({name: \"login\"});\r\n            }\r\n        }catch (e){\r\n            NextErrorRedir(error_msg.could_not_verify_login.code,error_msg.could_not_verify_login.message);\r\n        }\r\n    }\r\n\r\n    async authAxios(axio,next){\r\n        let resp= await axio;\r\n        if(resp.info.code===601){\r\n            if(next!==undefined) {\r\n                next({name: \"login\"});\r\n                return false;\r\n            }else {\r\n                this.router.push(\"login\");\r\n                return false;\r\n            }\r\n        } else\r\n            return resp;\r\n    }\r\n\r\n    async axiosNoCred(axio){\r\n        axio.withCredentials=false;\r\n        let resp = await axio;\r\n        return resp;\r\n    }\r\n\r\n}"]}]}