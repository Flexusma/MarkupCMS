{"remainingRequest":"B:\\Gitkraken\\MarkupCMS\\client\\node_modules\\babel-loader\\lib\\index.js!B:\\Gitkraken\\MarkupCMS\\client\\node_modules\\eslint-loader\\index.js??ref--13-0!B:\\Gitkraken\\MarkupCMS\\client\\src\\auth\\authService.js","dependencies":[{"path":"B:\\Gitkraken\\MarkupCMS\\client\\src\\auth\\authService.js","mtime":1608827563583},{"path":"B:\\Gitkraken\\MarkupCMS\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"B:\\Gitkraken\\MarkupCMS\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"B:\\Gitkraken\\MarkupCMS\\client\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lLmpzIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkI6L0dpdGtyYWtlbi9NYXJrdXBDTVMvY2xpZW50L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IF9jbGFzc0NhbGxDaGVjayBmcm9tICJCOi9HaXRrcmFrZW4vTWFya3VwQ01TL2NsaWVudC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY2xhc3NDYWxsQ2hlY2siOwppbXBvcnQgX2NyZWF0ZUNsYXNzIGZyb20gIkI6L0dpdGtyYWtlbi9NYXJrdXBDTVMvY2xpZW50L25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVDbGFzcyI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiQjovR2l0a3Jha2VuL01hcmt1cENNUy9jbGllbnQvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKaW1wb3J0IHsgYXBpLCBjb25zdGFudCwgZXJyb3JfbXNnLCB2dWUgfSBmcm9tICJAL21haW4iOwppbXBvcnQgeyBOZXh0RXJyb3JSZWRpciB9IGZyb20gIkAvcm91dGVyL3JvdXRlcl91dGlscyI7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7Cgp2YXIgQXV0aFNlcnZpY2UgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIGZ1bmN0aW9uIEF1dGhTZXJ2aWNlKCkgewogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEF1dGhTZXJ2aWNlKTsKCiAgICBfZGVmaW5lUHJvcGVydHkodGhpcywgInVzZXIiLCB1bmRlZmluZWQpOwogIH0KCiAgX2NyZWF0ZUNsYXNzKEF1dGhTZXJ2aWNlLCBbewogICAga2V5OiAiaXNBdXRoZW50aWNhdGVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpc0F1dGhlbnRpY2F0ZWQoKSB7CiAgICAgIGlmICh0aGlzLmdldEF1dGgoKSA9PT0gdW5kZWZpbmVkKSB0aGlzLmNoZWNrQXV0aFJlcSgpOwogICAgICByZXR1cm4gdGhpcy5nZXRBdXRoKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAibG9naW5SZWRpcmVjdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9naW5SZWRpcmVjdCgpIHsKICAgICAgdGhpcy5jaGVja0F1dGhSZXEoKTsKICAgICAgY29uc29sZS5sb2codnVlKTsKICAgICAgdGhpcy5wdXNoKCJsb2dpbiIpOwogICAgfQogIH0sIHsKICAgIGtleTogImxvZ291dCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gbG9nb3V0KG9iaikgewogICAgICB2YXIgbG9nb3V0ID0gYXhpb3MoewogICAgICAgIG1ldGhvZDogJ2RlbGV0ZScsCiAgICAgICAgdXJsOiBhcGkuYXBpX2Jhc2VfdXJsICsgYXBpLmFwaV9zZXNzaW9uX3BhdGgKICAgICAgfSk7CiAgICAgIEF1dGhTZXJ2aWNlSW5zdGFuY2Uuc2V0QXV0aChmYWxzZSk7CiAgICAgIHRoaXMuYXV0aEF4aW9zTm9SZWQobG9nb3V0KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwoKICAgICAgICBpZiAocmVzLmRhdGEuaW5mby5jb2RlID09PSAyMDApIHsKICAgICAgICAgIGlmIChvYmogIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAvL2lmIChvYmoucmV0dXJuVG8gIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAvLyAgICB2dWUuJHJvdXRlci5wdXNoKG9iai5yZXR1cm5Ubyk7CiAgICAgICAgICAgIC8vfSBlbHNlIHsKICAgICAgICAgICAgdnVlLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgQXV0aFNlcnZpY2VJbnN0YW5jZS5zZXRBdXRoKGZhbHNlKTsKICAgICAgICAgICAgICBBdXRoU2VydmljZUluc3RhbmNlLnB1c2goY29uc3RhbnQuaG9tZV9wYWdlX25hbWUpOwogICAgICAgICAgICAgIHZ1ZS4kcm9vdC4kcm91dGVyLmdvKDApOwogICAgICAgICAgICAgIHZ1ZS4kcm9vdC4kcm91dGVyLmdvKDApOwogICAgICAgICAgICB9KTsgLy8gfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHRoaXMuY2hlY2tBdXRoUmVxKCk7CiAgICB9CiAgfSwgewogICAga2V5OiAicm91dGVBdXRoQ2hlY2siLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9yb3V0ZUF1dGhDaGVjayA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZShuZXh0KSB7CiAgICAgICAgdmFyIGF4OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tBdXRoUmVxKCk7CiAgICAgICAgICAgICAgICBheCA9IGF4aW9zLmdldChhcGkuYXBpX2Jhc2VfdXJsICsgYXBpLmFwaV90b2tlbl9jaGVja191cmwpOwogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDI7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmF1dGhBeGlvcyhheCwgbmV4dCk7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHQuc2VudDsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnQxID0gdW5kZWZpbmVkOwoKICAgICAgICAgICAgICAgIGlmICghKF9jb250ZXh0LnQwICE9PSBfY29udGV4dC50MSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDExOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTI7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgIC8vanVzdCBpbiBjYXNlIEF1dGhBeGlvcyBmYWlscwogICAgICAgICAgICAgICAgbmV4dCh7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICJsb2dpbiIKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDEyOgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE4OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTQ7CiAgICAgICAgICAgICAgICBfY29udGV4dC50MiA9IF9jb250ZXh0WyJjYXRjaCJdKDIpOwogICAgICAgICAgICAgICAgY29uc29sZS5sb2coX2NvbnRleHQudDIpOwogICAgICAgICAgICAgICAgTmV4dEVycm9yUmVkaXIoZXJyb3JfbXNnLmNvdWxkX25vdF92ZXJpZnlfbG9naW4uY29kZSwgZXJyb3JfbXNnLmNvdWxkX25vdF92ZXJpZnlfbG9naW4ubWVzc2FnZSwgbmV4dCk7CgogICAgICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCB0aGlzLCBbWzIsIDE0XV0pOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiByb3V0ZUF1dGhDaGVjayhfeCkgewogICAgICAgIHJldHVybiBfcm91dGVBdXRoQ2hlY2suYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJvdXRlQXV0aENoZWNrOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiYXV0aEF4aW9zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfYXV0aEF4aW9zID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMihheGlvLCBuZXh0KSB7CiAgICAgICAgdmFyIHJlc3A7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHRoaXMuY2hlY2tBdXRoUmVxKCk7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gYXhpbzsKCiAgICAgICAgICAgICAgY2FzZSAzOgogICAgICAgICAgICAgICAgcmVzcCA9IF9jb250ZXh0Mi5zZW50OwoKICAgICAgICAgICAgICAgIGlmICghKHJlc3AuZGF0YS5pbmZvLmNvZGUgPT09IDYwMSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSAxNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCEobmV4dCAhPT0gdW5kZWZpbmVkKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDEwOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBuZXh0KHsKICAgICAgICAgICAgICAgICAgbmFtZTogImxvZ2luIgogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgZmFsc2UpOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgICAgdnVlLiRyb3V0ZXIucHVzaCgibG9naW4iKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBmYWxzZSk7CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE1OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgcmVzcCk7CgogICAgICAgICAgICAgIGNhc2UgMTU6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBhdXRoQXhpb3MoX3gyLCBfeDMpIHsKICAgICAgICByZXR1cm4gX2F1dGhBeGlvcy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gYXV0aEF4aW9zOwogICAgfSgpCiAgfSwgewogICAga2V5OiAiYXV0aEF4aW9zTm9SZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9hdXRoQXhpb3NOb1JlZCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoYXhpbykgewogICAgICAgIHZhciByZXNwOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICB0aGlzLmNoZWNrQXV0aFJlcSgpOwogICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIGF4aW87CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIHJlc3AgPSBfY29udGV4dDMuc2VudDsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuYWJydXB0KCJyZXR1cm4iLCByZXNwKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzLCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gYXV0aEF4aW9zTm9SZWQoX3g0KSB7CiAgICAgICAgcmV0dXJuIF9hdXRoQXhpb3NOb1JlZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gYXV0aEF4aW9zTm9SZWQ7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJsb2dpbldpdGhDcmVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfbG9naW5XaXRoQ3JlZCA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQodXNlciwgcGFzcykgewogICAgICAgIHZhciByZXNwOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDI7CiAgICAgICAgICAgICAgICByZXR1cm4gYXhpb3MucG9zdChhcGkuYXBpX2Jhc2VfdXJsICsgYXBpLmFwaV9zZXNzaW9uX3BhdGgsICIiLCB7CiAgICAgICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICAgICAneF91c2VyJzogdXNlciwKICAgICAgICAgICAgICAgICAgICAneF9wYXNzJzogcGFzcwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgcmVzcCA9IF9jb250ZXh0NC5zZW50OwogICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcCk7CgogICAgICAgICAgICAgICAgaWYgKCEocmVzcC5kYXRhLmluZm8uY29kZSA9PT0gMjAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDEyOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0aGlzLnVzZXIgPSByZXNwLmRhdGEuZGF0YVswXTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3AuZGF0YS5kYXRhKTsKICAgICAgICAgICAgICAgIHRoaXMuc2V0QXV0aCh0cnVlKTsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCJzZXR0aW5nIGF1dGggdG8gdHJ1ZSIpOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIsIHJlc3AuZGF0YSk7CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgcmVzcC5kYXRhKTsKCiAgICAgICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNCwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGxvZ2luV2l0aENyZWQoX3g1LCBfeDYpIHsKICAgICAgICByZXR1cm4gX2xvZ2luV2l0aENyZWQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGxvZ2luV2l0aENyZWQ7CiAgICB9KCkKICB9LCB7CiAgICBrZXk6ICJjaGVja0F1dGhSZXEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNoZWNrQXV0aFJlcSgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGF4aW9zLmdldChhcGkuYXBpX2Jhc2VfdXJsICsgYXBpLmFwaV9zZXNzaW9uX2NoZWNrX3BhdGgpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRhKTsKCiAgICAgICAgaWYgKHJlcy5kYXRhLmluZm8uY29kZSA9PT0gMjAwKSB7CiAgICAgICAgICBfdGhpcy5zZXRBdXRoKHRydWUpOwoKICAgICAgICAgIF90aGlzLnVzZXIgPSByZXMuZGF0YS5kYXRhOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBfdGhpcy5zZXRBdXRoKGZhbHNlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sIHsKICAgIGtleTogInB1c2giLAogICAgdmFsdWU6IGZ1bmN0aW9uIHB1c2godG8pIHsKICAgICAgaWYgKHZ1ZS4kcm91dGUubmFtZSAhPT0gdG8pIHsKICAgICAgICB2dWUuJHJvdXRlci5wdXNoKHsKICAgICAgICAgIG5hbWU6IHRvCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJzZXRBdXRoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRBdXRoKHQpIHsKICAgICAgdnVlLiRyb290LiRkYXRhLmlzQXV0aCA9IHQ7CiAgICB9CiAgfSwgewogICAga2V5OiAiZ2V0QXV0aCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0QXV0aCgpIHsKICAgICAgaWYgKHZ1ZSAhPT0gdW5kZWZpbmVkKSByZXR1cm4gdnVlLiRyb290LiRkYXRhLmlzQXV0aDtlbHNlIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gQXV0aFNlcnZpY2U7Cn0oKTsKCnZhciBBdXRoU2VydmljZUluc3RhbmNlID0gbmV3IEF1dGhTZXJ2aWNlKCk7CmV4cG9ydCBkZWZhdWx0IEF1dGhTZXJ2aWNlSW5zdGFuY2U7CmV4cG9ydCBmdW5jdGlvbiBpbml0QXV0aFNlcnZpY2UodnVlKSB7CiAgQXV0aFNlcnZpY2VJbnN0YW5jZS5jaGVja0F1dGhSZXEoKTsKICB2dWUucHJvdG90eXBlLiRhdXRoID0gQXV0aFNlcnZpY2VJbnN0YW5jZTsKfQ=="},{"version":3,"sources":["B:/Gitkraken/MarkupCMS/client/src/auth/authService.js"],"names":["api","constant","error_msg","vue","NextErrorRedir","axios","AuthService","undefined","getAuth","checkAuthReq","console","log","push","obj","logout","method","url","api_base_url","api_session_path","AuthServiceInstance","setAuth","authAxiosNoRed","then","res","data","info","code","$nextTick","home_page_name","$root","$router","go","next","ax","get","api_token_check_url","authAxios","name","could_not_verify_login","message","axio","resp","user","pass","post","headers","api_session_check_path","to","$route","t","$data","isAuth","initAuthService","prototype","$auth"],"mappings":";;;;;;AAAA,SAAQA,GAAR,EAAaC,QAAb,EAAuBC,SAAvB,EAAkCC,GAAlC,QAA4C,QAA5C;AACA,SAAQC,cAAR,QAA6B,uBAA7B;AACA,OAAOC,KAAP,MAAkB,OAAlB;;IAEMC,W;;;;kCASKC,S;;;;;sCANU;AACb,UAAG,KAAKC,OAAL,OAAiBD,SAApB,EACI,KAAKE,YAAL;AACJ,aAAO,KAAKD,OAAL,EAAP;AACH;;;oCAIc;AACX,WAAKC,YAAL;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAYR,GAAZ;AACA,WAAKS,IAAL,CAAU,OAAV;AACH;;;2BAEMC,G,EAAI;AAEP,UAAIC,MAAM,GAAGT,KAAK,CAAC;AACfU,QAAAA,MAAM,EAAE,QADO;AAEfC,QAAAA,GAAG,EAAEhB,GAAG,CAACiB,YAAJ,GAAiBjB,GAAG,CAACkB;AAFX,OAAD,CAAlB;AAIAC,MAAAA,mBAAmB,CAACC,OAApB,CAA4B,KAA5B;AACA,WAAKC,cAAL,CAAoBP,MAApB,EAA4BQ,IAA5B,CAAiC,UAAUC,GAAV,EAAc;AAC3Cb,QAAAA,OAAO,CAACC,GAAR,CAAYY,GAAZ;;AAEA,YAAGA,GAAG,CAACC,IAAJ,CAASC,IAAT,CAAcC,IAAd,KAAqB,GAAxB,EAA6B;AACzB,cAAIb,GAAG,KAAKN,SAAZ,EAAuB;AACnB;AACA;AACA;AACAJ,YAAAA,GAAG,CAACwB,SAAJ,CAAc,YAAI;AACdR,cAAAA,mBAAmB,CAACC,OAApB,CAA4B,KAA5B;AACAD,cAAAA,mBAAmB,CAACP,IAApB,CAAyBX,QAAQ,CAAC2B,cAAlC;AACAzB,cAAAA,GAAG,CAAC0B,KAAJ,CAAUC,OAAV,CAAkBC,EAAlB,CAAqB,CAArB;AACA5B,cAAAA,GAAG,CAAC0B,KAAJ,CAAUC,OAAV,CAAkBC,EAAlB,CAAqB,CAArB;AACH,aALD,EAJmB,CAWpB;AACF;AACJ;AACJ,OAlBD;AAmBA,WAAKtB,YAAL;AAGH;;;;qGAEoBuB,I;;;;;;AACjB,qBAAKvB,YAAL;AACIwB,gBAAAA,E,GAAK5B,KAAK,CAAC6B,GAAN,CAAUlC,GAAG,CAACiB,YAAJ,GAAiBjB,GAAG,CAACmC,mBAA/B,C;;;uBAEK,KAAKC,SAAL,CAAeH,EAAf,EAAmBD,IAAnB,C;;;;8BAA2BzB,S;;;;;;;AACjCyB,gBAAAA,IAAI;;;;;AAEJ;AACAA,gBAAAA,IAAI,CAAC;AAACK,kBAAAA,IAAI,EAAE;AAAP,iBAAD,CAAJ;;;;;;;;;AAGJ3B,gBAAAA,OAAO,CAACC,GAAR;AACAP,gBAAAA,cAAc,CAACF,SAAS,CAACoC,sBAAV,CAAiCZ,IAAlC,EAAuCxB,SAAS,CAACoC,sBAAV,CAAiCC,OAAxE,EAAgFP,IAAhF,CAAd;;;;;;;;;;;;;;;;;;;iGAIQQ,I,EAAKR,I;;;;;;AACjB,qBAAKvB,YAAL;;uBACgB+B,I;;;AAAZC,gBAAAA,I;;sBACDA,IAAI,CAACjB,IAAL,CAAUC,IAAV,CAAeC,IAAf,KAAsB,G;;;;;sBAClBM,IAAI,KAAGzB,S;;;;;AACNyB,gBAAAA,IAAI,CAAC;AAACK,kBAAAA,IAAI,EAAE;AAAP,iBAAD,CAAJ;kDACO,K;;;AAEPlC,gBAAAA,GAAG,CAAC2B,OAAJ,CAAYlB,IAAZ,CAAiB,OAAjB;kDACO,K;;;;;;;kDAGJ6B,I;;;;;;;;;;;;;;;;;;;sGAGMD,I;;;;;;AACjB,qBAAK/B,YAAL;;uBACiB+B,I;;;AAAbC,gBAAAA,I;kDACGA,I;;;;;;;;;;;;;;;;;;;qGAGSC,I,EAAMC,I;;;;;;;uBACLtC,KAAK,CAACuC,IAAN,CAAW5C,GAAG,CAACiB,YAAJ,GAAiBjB,GAAG,CAACkB,gBAAhC,EAAiD,EAAjD,EAAoD;AAAC2B,kBAAAA,OAAO,EAAC;AAC1E,8BAASH,IADiE;AAE1E,8BAASC;AAFiE;AAAT,iBAApD,C;;;AAAbF,gBAAAA,I;AAKJ/B,gBAAAA,OAAO,CAACC,GAAR,CAAY8B,IAAZ;;sBACGA,IAAI,CAACjB,IAAL,CAAUC,IAAV,CAAeC,IAAf,KAAsB,G;;;;;AACrB,qBAAKgB,IAAL,GAAYD,IAAI,CAACjB,IAAL,CAAUA,IAAV,CAAe,CAAf,CAAZ;AACAd,gBAAAA,OAAO,CAACC,GAAR,CAAY8B,IAAI,CAACjB,IAAL,CAAUA,IAAtB;AACA,qBAAKJ,OAAL,CAAa,IAAb;AACAV,gBAAAA,OAAO,CAACC,GAAR,CAAY,sBAAZ;kDACO8B,IAAI,CAACjB,I;;;kDACHiB,IAAI,CAACjB,I;;;;;;;;;;;;;;;;;;mCAGR;AAAA;;AACVnB,MAAAA,KAAK,CAAC6B,GAAN,CAAUlC,GAAG,CAACiB,YAAJ,GAAiBjB,GAAG,CAAC8C,sBAA/B,EAAuDxB,IAAvD,CAA4D,UAACC,GAAD,EAAS;AACjEb,QAAAA,OAAO,CAACC,GAAR,CAAYY,GAAG,CAACC,IAAhB;;AACA,YAAGD,GAAG,CAACC,IAAJ,CAASC,IAAT,CAAcC,IAAd,KAAqB,GAAxB,EAA6B;AACzB,UAAA,KAAI,CAACN,OAAL,CAAa,IAAb;;AACA,UAAA,KAAI,CAACsB,IAAL,GAAUnB,GAAG,CAACC,IAAJ,CAASA,IAAnB;AACH,SAHD,MAII;AACA,UAAA,KAAI,CAACJ,OAAL,CAAa,KAAb;AACH;AACJ,OATD;AAUH;;;yBAEI2B,E,EAAG;AACJ,UAAG5C,GAAG,CAAC6C,MAAJ,CAAWX,IAAX,KAAkBU,EAArB,EAAwB;AACpB5C,QAAAA,GAAG,CAAC2B,OAAJ,CAAYlB,IAAZ,CAAiB;AAACyB,UAAAA,IAAI,EAAEU;AAAP,SAAjB;AACH;AACJ;;;4BACOE,C,EAAE;AACR9C,MAAAA,GAAG,CAAC0B,KAAJ,CAAUqB,KAAV,CAAgBC,MAAhB,GAAyBF,CAAzB;AACD;;;8BACQ;AACL,UAAG9C,GAAG,KAAGI,SAAT,EACI,OAAOJ,GAAG,CAAC0B,KAAJ,CAAUqB,KAAV,CAAgBC,MAAvB,CADJ,KAEK,OAAO5C,SAAP;AACR;;;;;;AAML,IAAIY,mBAAmB,GAAG,IAAIb,WAAJ,EAA1B;AAEA,eAAea,mBAAf;AAEA,OAAO,SAASiC,eAAT,CAAyBjD,GAAzB,EAA6B;AAEhCgB,EAAAA,mBAAmB,CAACV,YAApB;AACAN,EAAAA,GAAG,CAACkD,SAAJ,CAAcC,KAAd,GAAoBnC,mBAApB;AAEH","sourcesContent":["import {api, constant, error_msg, vue} from \"@/main\";\r\nimport {NextErrorRedir} from \"@/router/router_utils\";\r\nimport axios from 'axios';\r\n\r\nclass AuthService{\r\n\r\n\r\n    isAuthenticated(){\r\n        if(this.getAuth()===undefined)\r\n            this.checkAuthReq();\r\n        return this.getAuth()\r\n    }\r\n\r\n    user = undefined;\r\n\r\n    loginRedirect(){\r\n        this.checkAuthReq();\r\n        console.log(vue);\r\n        this.push(\"login\");\r\n    }\r\n\r\n    logout(obj){\r\n\r\n        let logout = axios({\r\n            method: 'delete',\r\n            url: api.api_base_url+api.api_session_path,\r\n        })\r\n        AuthServiceInstance.setAuth(false);\r\n        this.authAxiosNoRed(logout).then(function (res){\r\n            console.log(res)\r\n\r\n            if(res.data.info.code===200) {\r\n                if (obj !== undefined) {\r\n                    //if (obj.returnTo !== undefined) {\r\n                    //    vue.$router.push(obj.returnTo);\r\n                    //} else {\r\n                    vue.$nextTick(()=>{\r\n                        AuthServiceInstance.setAuth(false);\r\n                        AuthServiceInstance.push(constant.home_page_name);\r\n                        vue.$root.$router.go(0);\r\n                        vue.$root.$router.go(0);\r\n                    });\r\n\r\n                   // }\r\n                }\r\n            }\r\n        });\r\n        this.checkAuthReq();\r\n\r\n\r\n    }\r\n\r\n    async routeAuthCheck(next){\r\n        this.checkAuthReq();\r\n        let ax = axios.get(api.api_base_url+api.api_token_check_url);\r\n        try {\r\n            if (await this.authAxios(ax, next)!==undefined) {\r\n                next();\r\n            } else {\r\n                //just in case AuthAxios fails\r\n                next({name: \"login\"});\r\n            }\r\n        }catch (e){\r\n            console.log(e);\r\n            NextErrorRedir(error_msg.could_not_verify_login.code,error_msg.could_not_verify_login.message,next);\r\n        }\r\n    }\r\n\r\n    async authAxios(axio,next){\r\n        this.checkAuthReq();\r\n        let resp= await axio;\r\n        if(resp.data.info.code===601){\r\n            if(next!==undefined) {\r\n                next({name: \"login\"});\r\n                return false;\r\n            }else {\r\n                vue.$router.push(\"login\");\r\n                return false;\r\n            }\r\n        } else\r\n            return resp;\r\n    }\r\n\r\n    async authAxiosNoRed(axio){\r\n        this.checkAuthReq();\r\n        let resp = await axio;\r\n        return resp;\r\n    }\r\n\r\n    async loginWithCred(user, pass){\r\n        let resp = await axios.post(api.api_base_url+api.api_session_path,\"\",{headers:{\r\n            'x_user':user,\r\n            'x_pass':pass\r\n        },\r\n        });\r\n        console.log(resp);\r\n        if(resp.data.info.code===200){\r\n            this.user = resp.data.data[0];\r\n            console.log(resp.data.data)\r\n            this.setAuth(true);\r\n            console.log(\"setting auth to true\");\r\n            return resp.data;\r\n        }else return resp.data;\r\n    }\r\n\r\n    checkAuthReq(){\r\n        axios.get(api.api_base_url+api.api_session_check_path).then((res) => {\r\n            console.log(res.data);\r\n            if(res.data.info.code===200) {\r\n                this.setAuth(true)\r\n                this.user=res.data.data;\r\n            }\r\n            else{\r\n                this.setAuth(false)\r\n            }\r\n        })\r\n    }\r\n\r\n    push(to){\r\n        if(vue.$route.name!==to){\r\n            vue.$router.push({name: to});\r\n        }\r\n    }\r\n    setAuth(t){\r\n      vue.$root.$data.isAuth = t;\r\n    }\r\n    getAuth(){\r\n        if(vue!==undefined)\r\n            return vue.$root.$data.isAuth;\r\n        else return undefined;\r\n    }\r\n\r\n}\r\n\r\n\r\n\r\nlet AuthServiceInstance = new AuthService();\r\n\r\nexport default AuthServiceInstance;\r\n\r\nexport function initAuthService(vue){\r\n\r\n    AuthServiceInstance.checkAuthReq();\r\n    vue.prototype.$auth=AuthServiceInstance;\r\n\r\n}"]}]}